pipeline {
    agent any
    
    stages {
        stage('Test Connection') {
            steps {
                echo '🔍 测试Jenkins连接...'
                echo "工作空间: ${env.WORKSPACE}"
                echo "构建号: ${env.BUILD_NUMBER}"
                echo "Jenkins URL: ${env.JENKINS_URL}"
                
                // 检查工作空间内容
                sh 'pwd'
                sh 'ls -la'
                
                // 检查Git状态
                sh 'git --version || echo "Git未安装"'
                sh 'git status || echo "不是Git仓库"'
            }
        }
        
        stage('Environment Check') {
            steps {
                echo '🔧 检查环境...'
                sh 'whoami'
                sh 'env | sort'
                sh 'which node || echo "Node.js未找到"'
                sh 'which docker || echo "Docker未找到"'
            }
        }
    }
    
    post {
        always {
            echo '✅ 测试完成'
        }
    }
}